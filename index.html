<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Master Cheatsheet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'sans-serif'],
                        mono: ['"Fira Code"', 'monospace'],
                    },
                    colors: {
                        brand: {
                            50: '#fff1f0',
                            100: '#ffdfdb',
                            500: '#f05032', // Git Orange
                            600: '#dd4b2e',
                            900: '#1a1a1a',
                        },
                        dark: {
                            bg: '#0D1117', // GitHub Dark Dimmed BG
                            card: '#161B22',
                            border: '#30363D',
                            text: '#C9D1D9',
                            muted: '#8B949E'
                        }
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(240, 80, 50, 0.15)',
                    }
                }
            }
        }
    </script>
    <style>
        /* Syntax Highlighting Colors */
        .syntax-git { color: #f05032; font-weight: 700; }
        .syntax-flag { color: #79c0ff; }
        .syntax-string { color: #a5d6ff; }
        .syntax-param { color: #d2a8ff; font-style: italic; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #58a6ff; }

        .glass-panel {
            background: rgba(22, 27, 34, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(48, 54, 61, 0.5);
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-[#0D1117] text-[#C9D1D9] font-sans antialiased selection:bg-brand-500/30 selection:text-white relative overflow-x-hidden">

    <!-- Background Decoration -->
    <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div class="absolute top-[-10%] right-[-5%] w-[500px] h-[500px] bg-brand-500/10 rounded-full blur-[120px]"></div>
        <div class="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-blue-600/10 rounded-full blur-[120px]"></div>
    </div>

    <div class="flex h-screen overflow-hidden">

        <!-- Sidebar -->
        <aside class="hidden lg:flex flex-col w-72 h-full border-r border-dark-border bg-[#010409]/95 backdrop-blur-xl z-20">
            <div class="p-6 border-b border-dark-border/50">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-brand-500 to-orange-600 flex items-center justify-center shadow-lg shadow-brand-500/20">
                        <i data-lucide="git-merge" class="text-white w-6 h-6"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-xl tracking-tight text-white">Git Master</h1>
                        <p class="text-xs text-dark-muted font-mono">v2.1.0</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 overflow-y-auto p-4 space-y-1" id="sidebarNav">
                <!-- Nav items generated by JS -->
            </nav>

            <div class="p-4 border-t border-dark-border/50">
                <a href="https://git-scm.com/doc" target="_blank" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-dark-card border border-dark-border hover:border-brand-500/50 transition-colors group">
                    <div class="w-8 h-8 rounded-lg bg-dark-bg flex items-center justify-center text-dark-muted group-hover:text-brand-500 transition-colors">
                        <i data-lucide="book" class="w-4 h-4"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-white truncate">Git Documentation</p>
                        <p class="text-xs text-dark-muted truncate">git-scm.com</p>
                    </div>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 h-full overflow-y-auto relative scroll-smooth" id="mainScroll">

            <!-- Mobile Header -->
            <div class="lg:hidden sticky top-0 z-30 glass-panel border-b-0 border-b-dark-border px-4 py-3 flex items-center justify-between mb-4">
                <div class="flex items-center gap-2 font-bold text-lg text-white">
                    <i data-lucide="git-merge" class="text-brand-500"></i> Git Master
                </div>
                <button id="mobileMenuBtn" class="p-2 text-dark-text hover:text-white bg-dark-card rounded-lg border border-dark-border">
                    <i data-lucide="menu"></i>
                </button>
            </div>

            <!-- Mobile Menu Overlay -->
            <div id="mobileMenu" class="fixed inset-0 z-50 bg-[#0D1117] transform translate-x-full transition-transform duration-300 lg:hidden flex flex-col">
                <div class="p-4 flex justify-between items-center border-b border-dark-border">
                    <span class="font-bold text-xl">Menu</span>
                    <button id="closeMenuBtn" class="p-2 hover:bg-dark-card rounded-lg"><i data-lucide="x"></i></button>
                </div>
                <nav class="flex-1 overflow-y-auto p-4 space-y-2" id="mobileNavContent"></nav>
            </div>

            <div class="max-w-5xl mx-auto p-4 lg:p-10 pb-32">

                <!-- Hero Search -->
                <div class="relative mb-12 group z-20">
                    <div class="absolute -inset-1 bg-gradient-to-r from-brand-500 to-blue-600 rounded-2xl opacity-20 group-hover:opacity-40 transition duration-500 blur"></div>
                    <div class="relative bg-dark-card border border-dark-border rounded-xl p-2 flex items-center shadow-2xl">
                        <div class="pl-4 text-dark-muted">
                            <i data-lucide="search" class="w-6 h-6"></i>
                        </div>
                        <input type="text" id="searchInput"
                            class="w-full bg-transparent border-none text-white text-lg placeholder-dark-muted focus:ring-0 focus:outline-none px-4 py-3 font-medium"
                            placeholder="Tìm lệnh Git... (VD: commit, undo, stash, merge)" autocomplete="off">
                        <div class="hidden md:flex items-center gap-2 pr-4">
                            <kbd class="hidden sm:inline-block px-2 py-1 text-xs font-mono font-semibold text-dark-muted bg-dark-bg border border-dark-border rounded-md shadow-sm">CTRL K</kbd>
                        </div>
                    </div>
                </div>

                <!-- Content Area -->
                <div id="content" class="space-y-16">
                    <!-- Sections generated here -->
                </div>

                <!-- Footer -->
                <footer class="mt-20 pt-10 border-t border-dark-border text-center text-dark-muted">
                    <p>Git Master Cheatsheet • <span class="text-brand-500">Fixed & Enhanced</span></p>
                </footer>
            </div>
        </main>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed top-6 right-6 z-50 transform transition-all duration-300 translate-x-full opacity-0 pointer-events-none">
        <div class="bg-dark-card border border-brand-500/50 text-white px-4 py-3 rounded-xl shadow-glow flex items-center gap-3">
            <div class="bg-brand-500/20 p-1.5 rounded-full text-brand-500">
                <i data-lucide="check" class="w-4 h-4"></i>
            </div>
            <div>
                <p class="text-sm font-semibold">Đã sao chép!</p>
                <p class="text-xs text-dark-muted">Lệnh đã được lưu vào clipboard</p>
            </div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const categories = [
            {
                id: 'setup',
                name: 'Cấu hình (Setup)',
                icon: 'settings',
                color: 'text-blue-400',
                items: [
                    { cmd: 'git config --global user.name "Your Name"', desc: 'Đặt tên hiển thị' },
                    { cmd: 'git config --global user.email "mail@ex.com"', desc: 'Đặt email (quan trọng)' },
                    { cmd: 'git config --list', desc: 'Kiểm tra danh sách cấu hình' },
                    { cmd: 'git config --global core.editor "code --wait"', desc: 'Dùng VS Code làm editor mặc định' },
                    { cmd: 'git init -b main', desc: 'Khởi tạo repo mới với nhánh main' },
                    { cmd: 'git config --global alias.st status', desc: 'Tạo lệnh tắt (alias)' }
                ]
            },
            {
                id: 'basics',
                name: 'Cơ bản (Basics)',
                icon: 'zap',
                color: 'text-yellow-400',
                items: [
                    { cmd: 'git clone <url>', desc: 'Clone repo từ remote' },
                    { cmd: 'git status', desc: 'Kiểm tra trạng thái file' },
                    { cmd: 'git diff', desc: 'Xem thay đổi chưa staged' },
                    { cmd: 'git add .', desc: 'Thêm tất cả file vào Staging' },
                    { cmd: 'git add -p', desc: 'Thêm file theo từng đoạn (interactive)' },
                    { cmd: 'git commit -m "Message"', desc: 'Commit với tin nhắn' },
                    { cmd: 'git commit -am "Message"', desc: 'Add và Commit cùng lúc' },
                    { cmd: 'git log --oneline --graph --all', desc: 'Xem lịch sử commit đẹp' }
                ]
            },
            {
                id: 'branch',
                name: 'Nhánh (Branching)',
                icon: 'git-branch',
                color: 'text-purple-400',
                items: [
                    { cmd: 'git branch', desc: 'Liệt kê các nhánh' },
                    { cmd: 'git branch -v', desc: 'Liệt kê nhánh kèm commit cuối' },
                    { cmd: 'git checkout -b <name>', desc: 'Tạo và chuyển nhánh mới' },
                    { cmd: 'git checkout <branch>', desc: 'Chuyển nhánh' },
                    { cmd: 'git branch -d <branch>', desc: 'Xóa nhánh (đã merge)' },
                    { cmd: 'git branch -D <branch>', desc: 'Ép xóa nhánh (chưa merge)' },
                    { cmd: 'git merge <branch>', desc: 'Merge nhánh vào hiện tại' },
                    { cmd: 'git merge --no-ff <branch>', desc: 'Merge luôn tạo commit mới' }
                ]
            },
            {
                id: 'remote',
                name: 'Remote & Sync',
                icon: 'cloud',
                color: 'text-cyan-400',
                items: [
                    { cmd: 'git remote -v', desc: 'Xem danh sách remote' },
                    { cmd: 'git remote add origin <url>', desc: 'Thêm remote mới' },
                    { cmd: 'git fetch --prune', desc: 'Đồng bộ và xóa các nhánh rác' },
                    { cmd: 'git pull', desc: 'Pull code (Fetch + Merge)' },
                    { cmd: 'git pull --rebase', desc: 'Pull code dùng Rebase (sạch lịch sử)' },
                    { cmd: 'git push origin <branch>', desc: 'Push code lên remote' },
                    { cmd: 'git push -u origin <branch>', desc: 'Push và set upstream (lần đầu)' },
                    { cmd: 'git push --force-with-lease', desc: 'Force push an toàn' }
                ]
            },
            {
                id: 'undo',
                name: 'Hoàn tác (Undo)',
                icon: 'rotate-ccw',
                color: 'text-red-400',
                items: [
                    { cmd: 'git commit --amend', desc: 'Sửa commit cuối (tin nhắn/file)' },
                    { cmd: 'git restore <file>', desc: 'Hủy thay đổi file (chưa staged)' },
                    { cmd: 'git restore --staged <file>', desc: 'Bỏ file khỏi Staging (unstage)' },
                    { cmd: 'git reset --soft HEAD~1', desc: 'Hủy commit cuối, giữ lại thay đổi' },
                    { cmd: 'git reset --hard HEAD~1', desc: 'Hủy commit cuối, XÓA sạch thay đổi' },
                    { cmd: 'git revert <commit>', desc: 'Tạo commit đảo ngược (không xóa lịch sử)' },
                    { cmd: 'git clean -fd', desc: 'Xóa sạch file/folder untracked' }
                ]
            },
            {
                id: 'advanced',
                name: 'Nâng cao (Advanced)',
                icon: 'terminal',
                color: 'text-orange-400',
                items: [
                    { cmd: 'git stash', desc: 'Lưu tạm thay đổi đang làm dở' },
                    { cmd: 'git stash pop', desc: 'Lấy lại thay đổi đã stash' },
                    { cmd: 'git cherry-pick <commit>', desc: 'Lấy 1 commit từ nhánh khác' },
                    { cmd: 'git rebase <branch>', desc: 'Rebase (viết lại lịch sử)' },
                    { cmd: 'git rebase -i HEAD~3', desc: 'Sửa/Gộp 3 commit gần nhất' },
                    { cmd: 'git reflog', desc: 'Xem nhật ký tham chiếu (Cứu code bị mất)' },
                    { cmd: 'git bisect start', desc: 'Bắt đầu tìm lỗi nhị phân' }
                ]
            },
            {
                id: 'tags',
                name: 'Tags & Tìm kiếm',
                icon: 'tag',
                color: 'text-pink-400',
                items: [
                    { cmd: 'git tag -a v1.0 -m "Release"', desc: 'Tạo tag có ghi chú' },
                    { cmd: 'git push origin --tags', desc: 'Đẩy tất cả tag lên remote' },
                    { cmd: 'git tag -d <tag>', desc: 'Xóa tag local' },
                    { cmd: 'git grep "pattern"', desc: 'Tìm chuỗi trong code' },
                    { cmd: 'git log --grep="bug"', desc: 'Tìm commit theo tin nhắn' },
                    { cmd: 'git blame <file>', desc: 'Xem ai sửa dòng nào' }
                ]
            },
            {
                id: 'workflow',
                name: 'Workflows & Fork',
                icon: 'git-pull-request',
                color: 'text-green-400',
                items: [
                    { cmd: 'git remote add upstream <url>', desc: 'Thêm remote gốc (upstream)' },
                    { cmd: 'git fetch upstream', desc: 'Lấy code từ upstream' },
                    { cmd: 'git merge upstream/main', desc: 'Gộp code upstream vào local' },
                    { cmd: 'git submodule add <url>', desc: 'Thêm submodule' },
                    { cmd: 'git submodule update --init', desc: 'Cập nhật submodule' },
                    { cmd: 'git worktree add <path> <br>', desc: 'Tạo thư mục làm việc phụ' }
                ]
            }
        ];

        // --- FIXED HIGHLIGHTER ---

        function highlightCode(cmd) {
            // 1. Escape HTML special characters
            let html = cmd
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');

            // 2. Extract strings to prevent highlighting inside them (Fix bug here)
            const strings = [];
            // Match double or single quoted strings
            html = html.replace(/(".*?"|'.*?')/g, (match) => {
                strings.push(match);
                return `__STR${strings.length - 1}__`;
            });

            // 3. Highlight 'git' at the start
            html = html.replace(/^git\b/g, '<span class="syntax-git">git</span>');

            // 4. Highlight flags (e.g. -m, --global)
            // Look for space before flag or start of string
            html = html.replace(/(^|\s)(--?[\w-]+)(?=\s|$)/g, '$1<span class="syntax-flag">$2</span>');

            // 5. Highlight placeholders (e.g. <branch>) which are now &lt;branch&gt;
            html = html.replace(/(&lt;[\w-]+&gt;)/g, '<span class="syntax-param">$1</span>');

            // 6. Restore strings with highlighting
            html = html.replace(/__STR(\d+)__/g, (match, index) => {
                return `<span class="syntax-string">${strings[index]}</span>`;
            });

            return html;
        }

        // --- RENDER ---

        const contentEl = document.getElementById('content');
        const navEl = document.getElementById('sidebarNav');
        const mobileNavEl = document.getElementById('mobileNavContent');

        function render(filter = '') {
            contentEl.innerHTML = '';
            const lowerFilter = filter.toLowerCase().trim();
            let hasResults = false;

            categories.forEach(cat => {
                const filteredItems = cat.items.filter(item =>
                    item.cmd.toLowerCase().includes(lowerFilter) ||
                    item.desc.toLowerCase().includes(lowerFilter) ||
                    cat.name.toLowerCase().includes(lowerFilter)
                );

                if (filteredItems.length > 0) {
                    hasResults = true;
                    const section = document.createElement('section');
                    section.id = cat.id;
                    section.className = 'scroll-mt-24 animate-fade-in';

                    section.innerHTML = `
                        <div class="flex items-center gap-3 mb-6 pt-4 border-t border-dark-border/30 first:border-0 first:pt-0">
                            <div class="p-2 rounded-lg bg-dark-card border border-dark-border ${cat.color} shadow-sm">
                                <i data-lucide="${cat.icon}" class="w-6 h-6"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-white tracking-tight">${cat.name}</h2>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${filteredItems.map(item => `
                                <div class="group relative bg-dark-card border border-dark-border rounded-xl p-4 hover:border-brand-500/50 transition-all duration-300 hover:shadow-lg hover:shadow-black/50 hover:-translate-y-0.5">
                                    <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                                        <button onclick="copyCmd(this, '${item.cmd.replace(/'/g, "\\'")}')" class="p-1.5 bg-dark-bg text-dark-text hover:text-white hover:bg-brand-500 rounded-md transition-colors border border-dark-border" title="Copy">
                                            <i data-lucide="copy" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                    <p class="text-dark-muted text-sm font-medium mb-2.5 flex items-center gap-2 pr-8">
                                        ${item.desc}
                                    </p>
                                    <div class="bg-[#05090F] rounded-lg p-3 border border-dark-border/50 group-hover:border-dark-border transition-colors font-mono text-sm overflow-x-auto whitespace-nowrap">
                                        ${highlightCode(item.cmd)}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    contentEl.appendChild(section);
                }
            });

            if (!hasResults) {
                contentEl.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-20 text-dark-muted opacity-60">
                        <i data-lucide="search-x" class="w-16 h-16 mb-4"></i>
                        <p class="text-lg">Không tìm thấy lệnh nào phù hợp</p>
                    </div>
                `;
            }
            lucide.createIcons();
        }

        function renderNav() {
            const navHTML = categories.map(cat => `
                <a href="#${cat.id}" class="group flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-muted hover:text-white hover:bg-white/5 transition-all text-sm font-medium">
                    <i data-lucide="${cat.icon}" class="w-4 h-4 ${cat.color} opacity-70 group-hover:opacity-100 transition-opacity"></i>
                    ${cat.name.split('(')[0].trim()}
                </a>
            `).join('');

            navEl.innerHTML = navHTML;
            mobileNavEl.innerHTML = navHTML;
        }

        // --- ACTIONS ---

        window.copyCmd = (btn, cmd) => {
            navigator.clipboard.writeText(cmd).then(() => {
                // Toast
                const toast = document.getElementById('toast');
                toast.classList.remove('translate-x-full', 'opacity-0');

                // Button feedback
                const icon = btn.querySelector('i');
                const originalIcon = icon.getAttribute('data-lucide');

                // Don't re-render entire icon, just swap visual
                btn.innerHTML = '<i data-lucide="check" class="w-4 h-4"></i>';
                btn.classList.add('text-green-500', 'border-green-500/50');
                lucide.createIcons();

                setTimeout(() => {
                    toast.classList.add('translate-x-full', 'opacity-0');
                    btn.innerHTML = `<i data-lucide="${originalIcon}" class="w-4 h-4"></i>`;
                    btn.classList.remove('text-green-500', 'border-green-500/50');
                    lucide.createIcons();
                }, 2000);
            });
        };

        // --- INIT & EVENTS ---

        renderNav();
        render();

        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', (e) => render(e.target.value));

        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                searchInput.focus();
            }
        });

        // Mobile Menu
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const closeMenuBtn = document.getElementById('closeMenuBtn');

        function toggleMenu() {
            const isClosed = mobileMenu.classList.contains('translate-x-full');
            if (isClosed) {
                mobileMenu.classList.remove('translate-x-full');
            } else {
                mobileMenu.classList.add('translate-x-full');
            }
        }

        mobileMenuBtn.addEventListener('click', toggleMenu);
        closeMenuBtn.addEventListener('click', toggleMenu);

        // Close menu on nav click
        mobileNavEl.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                toggleMenu();
            });
        });

    </script>
</body>
</html>